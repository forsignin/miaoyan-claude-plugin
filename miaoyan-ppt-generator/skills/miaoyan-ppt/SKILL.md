---
name: miaoyan-ppt
description: 生成专业的妙言 Markdown 演示文稿,支持 Reveal.js 特性。当用户需要从零开始创建演示幻灯片、将内容转换为 PPT 格式或增强现有演示文稿(添加动画、背景和代码高亮)时使用此技能。适用于技术分享、产品演示、教学材料和商业提案。
---

# 妙言 PPT 生成器

## 概述

生成专业的妙言 Markdown 格式演示幻灯片,完全支持 Reveal.js。将想法、大纲或现有内容转换为具有动画、自定义背景、代码高亮和结构化布局的视觉吸引力幻灯片。

## 何时使用此技能

当用户请求以下场景时激活此技能:

- 从零开始创建新演示文稿
- 将文档或内容转换为幻灯片格式
- 从主题大纲或要点生成幻灯片
- 为演示文稿添加视觉效果(动画、背景)
- 创建技术分享、产品演示或教学材料
- 创建包含代码示例和语法高亮的演示文稿
- 使用 Reveal.js 特性增强现有演示文稿

**触发短语:** "创建 PPT"、"生成幻灯片"、"制作演示文稿"、"转换为幻灯片"、"妙言演示"、"生成幻灯片"

## 工作流决策树

```
用户请求
    ↓
是新建演示文稿吗?
    ├─ 是 → 遵循"创建新演示文稿"工作流
    └─ 否 → 是增强现有幻灯片吗?
        ├─ 是 → 遵循"增强演示文稿"工作流
        └─ 否 → 遵循"转换内容"工作流
```

## 创建新演示文稿

### 步骤 1: 理解需求

通过以下问题收集关键信息(如果未提供):

- **主题**: 演示文稿的内容是什么?
- **受众**: 谁会观看?(开发者、管理者、学生、客户)
- **目的**: 技术培训、产品发布、教学、商业提案?
- **范围**: 预期幻灯片数量或时长?
- **风格偏好**: 技术型、商务型、教育型、创意型?

如果缺少关键信息,使用 `AskUserQuestion` 工具。清晰地构建问题和选项。

### 步骤 2: 生成大纲

根据需求创建结构化大纲:

**标准结构:**
```
1. 封面幻灯片 - 标题 + 副标题
2. 目录(如果 > 10 张幻灯片)
3. 第一部分
   - 部分介绍(带背景)
   - 内容幻灯片(2-4 张)
4. 第二部分
   - 部分介绍
   - 内容幻灯片(2-4 张)
   - 代码示例(如果是技术内容)
5. 总结幻灯片
6. 问答幻灯片
```

**在生成内容之前,向用户展示大纲以确认。**

### 步骤 3: 选择模板

根据演示类型从 `assets/templates/` 中选择合适的模板:

- **tech-share-template.md**: 技术分享、架构讨论、代码演示
- **product-intro-template.md**: 产品发布、特性展示、路线图
- **teaching-template.md**: 教育内容、培训课程、教程

使用 `Read` 工具读取模板以理解结构和样式模式。

### 步骤 4: 配置 Reveal.js 设置

根据演示类型在文档开头添加内联配置:

**技术演示:**
```markdown
<!--
transition: convex
backgroundTransition: slide
transitionSpeed: default
controls: true
progress: true
slideNumber: c/t
-->
```

**产品演示:**
```markdown
<!--
transition: slide
backgroundTransition: fade
transitionSpeed: default
controls: true
progress: true
slideNumber: c/t
-->
```

**教育内容:**
```markdown
<!--
transition: none
transitionSpeed: fast
controls: true
progress: true
slideNumber: c/t
-->
```

参考 `references/reveal-js-syntax.md` 获取完整配置选项。

### 步骤 5: 生成幻灯片内容

按照以下模式创建幻灯片:

#### 封面幻灯片
```markdown
# 演示标题

副标题或简要描述

---
```

#### 部分介绍(带背景)
```markdown
<!-- .slide: data-background="#4A90E2" -->
## 部分名称

简要介绍或标语

---
```

**推荐的背景颜色:**
- 蓝色: `#4A90E2`, `#E3F2FD`
- 绿色: `#4CAF50`, `#E8F5E9`
- 橙色: `#FF9800`, `#FFF3E0`
- 紫色: `#9C27B0`, `#F3E5F5`
- 渐变: `data-background-gradient="linear-gradient(45deg, #667eea 0%, #764ba2 100%)"`

#### 带片段的内容幻灯片
```markdown
## 幻灯片标题

- 要点 1 <!-- .element: class="fragment" data-fragment-index="1" -->
- 要点 2 <!-- .element: class="fragment" data-fragment-index="2" -->
- 要点 3 <!-- .element: class="fragment" data-fragment-index="3" -->

---
```

#### 两栏布局
```markdown
## 对比

<div style="display: flex; gap: 2rem;">
<div style="flex: 1;">

**左栏**

- 项目 A
- 项目 B

</div>
<div style="flex: 1;">

**右栏**

- 项目 C
- 项目 D

</div>
</div>

---
```

#### 带高亮的代码示例
````markdown
## 代码演示

```python [1-3|5-7|9-11]
def initialize():
    """设置函数"""
    return config

def process(data):
    """处理数据"""
    return transform(data)

if __name__ == "__main__":
    initialize()
```

---
````

语法: `[1|2-3|4]` 依次高亮第 1 行、第 2-3 行、第 4 行。

#### 数据表格
```markdown
## 指标

| 特性 | 值 | 状态 |
|------|------|--------|
| 性能 | 高 | ✅ |
| 成本 | 低 | ✅ |
| 可扩展性 | 优秀 | ✅ |

---
```

#### 结束幻灯片
```markdown
<!-- .slide: data-background-gradient="linear-gradient(45deg, #667eea 0%, #764ba2 100%)" -->

# 谢谢

## 问题与解答

联系方式: your@email.com

---
```

### 步骤 6: 应用视觉增强

为重要内容使用片段动画。可用的片段类:

- `fragment` - 基本淡入
- `fragment fade-up` - 向上滑动
- `fragment fade-down` - 向下滑动
- `fragment highlight-red` - 红色高亮
- `fragment highlight-green` - 绿色高亮
- `fragment highlight-blue` - 蓝色高亮
- `fragment grow` - 放大
- `fragment shrink` - 缩小

示例:
```markdown
<p class="fragment fade-up">第一句话</p>
<p class="fragment highlight-red">重要强调</p>
<p class="fragment grow">关键结论</p>
```

参考 `references/reveal-js-syntax.md` 获取完整片段选项。

### 步骤 7: 输出文件

使用 `Write` 工具创建演示文件:

**文件命名:** `{主题}-presentation.md` 或用户指定的名称
**位置:** 当前工作目录或用户指定路径
**编码:** UTF-8

创建后,告知用户:
```
✅ 已生成妙言 PPT: {file_path}

📊 统计信息:
- 总幻灯片数: {N}
- 代码块: {N}
- 动画: {N}

🎯 使用方法:
在妙言中打开并按 Command + Option + P 进入演示模式
```

## 增强演示文稿

要为现有演示文稿添加视觉效果:

### 步骤 1: 读取现有文件

使用 `Read` 工具加载当前演示内容。

### 步骤 2: 识别增强机会

分析内容以确定在哪里添加:
- 关键要点的片段动画
- 部分分隔符的背景颜色
- 技术示例的代码高亮
- 布局改进(两栏、网格)

### 步骤 3: 应用增强

使用 `Edit` 工具修改文件:

**添加片段:**
```markdown
- 重要要点 <!-- .element: class="fragment" -->
```

**添加背景:**
```markdown
<!-- .slide: data-background="#4A90E2" -->
```

**添加代码高亮:**
````markdown
```python [1|2-4|5]
````

### 步骤 4: 验证并保存

确认更改保持正确的 Markdown 语法和 Reveal.js 兼容性。

## 转换内容

将现有文档转换为演示格式:

### 步骤 1: 读取源内容

使用 `Read` 工具加载源文件(Markdown、文本等)。

### 步骤 2: 分析结构

识别:
- 主要部分(成为部分介绍幻灯片)
- 子部分(成为内容幻灯片)
- 列表(使用片段动画)
- 代码块(添加行高亮)
- 表格(保持原样或增强)

### 步骤 3: 转换为幻灯片

将内容重组为幻灯片格式:
- 提取标题作为幻灯片标题
- 将长段落拆分为要点(每张幻灯片 3-5 个)
- 添加水平分隔符(`---`)
- 插入带背景的部分介绍幻灯片
- 为关键要点添加片段动画

### 步骤 4: 生成新文件

使用 `Write` 工具创建演示版本。

## 内容指南

遵循以下质量标准:

### 结构标准

- **必须有:** 封面幻灯片、部分介绍、总结/问答
- **推荐:** 如果 > 10 张幻灯片则添加目录
- **避免:** 单张幻灯片包含 > 7 个要点

### 内容标准

- **清晰标题:** 每张幻灯片都有描述性标题
- **简洁要点:** 每张幻灯片 3-5 个关键要点
- **渐进披露:** 使用片段逐步显示
- **代码清晰:** 高亮关键行,保持示例聚焦

### 视觉标准

- **一致颜色:** 全程使用相同色板
- **层次结构:** 部分介绍使用独特背景
- **强调:** 关键结论使用对比色
- **对齐:** 表格和代码块正确对齐

### 动画标准

- **逻辑顺序:** 按顺序设置 `data-fragment-index`
- **有目的使用:** 仅对重要内容使用动画
- **避免过度使用:** 每张幻灯片最多 5 个片段
- **代码进度:** 使用行范围逐步解释

## 质量检查清单

最终确定前验证:

- [ ] 配置头语法正确
- [ ] 每张幻灯片都有清晰标题
- [ ] 代码块有语言标识符
- [ ] 片段索引是连续的(如果使用)
- [ ] 背景颜色使用适当
- [ ] 无 Markdown 语法错误
- [ ] 中文标点符号正确(如适用)
- [ ] 文件编码为 UTF-8

## 错误处理

### 内容过长

如果单张幻灯片超过 200 字:
- 自动拆分为多张幻灯片
- 保持逻辑流程
- 通知用户分页情况

### 代码格式化

确保代码块具有:
- 正确的语言标识符
- 有效的行高亮语法: `[1|2-4|5-7]`
- 一致的缩进

### 配置冲突

如果用户需求与模板冲突:
- 优先使用用户指定的配置
- 通知用户覆盖情况

## 资源

### references/

- **reveal-js-syntax.md**: 完整的 Reveal.js Markdown 语法参考 - 需要语法细节时加载
- **template-examples.md**: 不同场景的示例演示 - 结构模式参考

### assets/templates/

- **tech-share-template.md**: 技术演示的完整模板
- **product-intro-template.md**: 产品演示的完整模板
- **teaching-template.md**: 教育内容的完整模板

**使用方法:** 读取模板以理解结构和样式模式,然后适配用户的具体内容。

## 最佳实践

1. **先理解**: 生成前明确主题和受众
2. **确认大纲**: 创建内容前向用户展示结构
3. **渐进显示**: 为重要内容使用片段
4. **视觉层次**: 使用背景分隔部分
5. **简洁**: 每张幻灯片一个核心思想
6. **代码聚焦**: 只显示关键代码,删除样板代码
7. **一致性**: 保持统一的颜色、字体和布局
8. **测试提醒**: 建议用户生成后在妙言中预览